import { NextRequest, NextResponse } from 'next/server'

// Popular Russian cities for autocomplete
const RUSSIAN_CITIES = [
  'Москва',
  'Санкт-Петербург',
  'Новосибирск',
  'Екатеринбург',
  'Казань',
  'Нижний Новгород',
  'Челябинск',
  'Самара',
  'Омск',
  'Ростов-на-Дону',
  'Уфа',
  'Красноярск',
  'Воронеж',
  'Пермь',
  'Волгоград',
  'Краснодар',
  'Саратов',
  'Тюмень',
  'Тольятти',
  'Ижевск',
  'Барнаул',
  'Ульяновск',
  'Иркутск',
  'Хабаровск',
  'Ярославль',
  'Владивосток',
  'Махачкала',
  'Томск',
  'Оренбург',
  'Кемерово',
  'Рязань',
  'Астрахань',
  'Набережные Челны',
  'Пенза',
  'Липецк',
  'Тула',
  'Киров',
  'Чебоксары',
  'Калининград',
  'Брянск',
  'Курск',
  'Магнитогорск',
  'Тверь',
  'Ставрополь',
  'Нижний Тагил',
  'Белгород',
  'Архангельск',
  'Владимир',
  'Сочи',
  'Курган',
  'Смоленск',
  'Калуга',
  'Чита',
  'Орёл',
  'Волжский',
  'Череповец',
  'Мурманск',
  'Сургут',
  'Вологда',
  'Владикавказ',
  'Саранск',
  'Тамбов',
  'Стерлитамак',
  'Грозный',
  'Якутск',
  'Кострома',
  'Комсомольск-на-Амуре',
  'Петрозаводск',
  'Таганрог',
  'Нижневартовск',
  'Йошкар-Ола',
  'Братск',
  'Новороссийск',
  'Шахты',
  'Нальчик',
  'Дзержинск',
  'Орск',
  'Сыктывкар',
  'Нижнекамск',
  'Ангарск',
  'Благовещенск',
  'Прокопьевск',
  'Химки',
  'Псков',
  'Бийск',
  'Энгельс',
  'Рыбинск',
  'Балаково',
  'Северодвинск',
  'Подольск',
  'Королёв',
  'Сызрань',
  'Норильск',
  'Златоуст',
  'Петропавловск-Камчатский',
  'Каменск-Уральский',
  'Люберцы',
  'Мытищи',
  'Псков',
  'Армавир',
  'Балашиха',
  'Северск',
  'Альметьевск',
  'Пушкино',
  'Одинцово',
  'Красногорск',
  'Реутов',
  'Жуковский',
  'Долгопрудный',
  'Королёв',
  'Химки',
  'Подольск',
  'Мытищи',
  'Люберцы',
  'Балашиха',
  'Пушкино',
  'Одинцово',
  'Красногорск',
  'Реутов',
  'Жуковский',
  'Долгопрудный'
]

export async function GET(request: NextRequest) {
  try {
    const searchParams = request.nextUrl.searchParams
    const query = searchParams.get('q')

    if (!query || query.length < 2) {
      return NextResponse.json([])
    }

    // Filter cities based on query
    const filteredCities = RUSSIAN_CITIES
      .filter(city => 
        city.toLowerCase().includes(query.toLowerCase())
      )
      .slice(0, 10) // Limit to 10 suggestions

    return NextResponse.json(filteredCities)
  } catch (error) {
    console.error('Error fetching cities:', error)
    return NextResponse.json({ error: 'Failed to fetch cities' }, { status: 500 })
  }
}
